# Flow Cytometry
Raw data from flow cytometry experiments in either .fcs format (generated by device) or .csv format (tabular data for data processing)

# Microscopy
Raw data from microscopy measurements in picture format, and .csv with identified diameters.

# Inference
Reference implementation & minimal working example of Gaussian process regression for the division rate inference.

**NOTE 1:** This implementation requires the `minimize.m` function from the [GPML Toolbox](https://gitlab.com/hnickisch/gpml-matlab) (under `util`-folder) associated with the book of Rasmussen and Williams. In case you have this toolbox installed, ensure that it it
s included on your Matlab search path. In case you do not have this toolbox installed, it suffices to only install `minimize.m` under the `+GP_Gamma/private/`-folder.

**NOTE 2:** All code in this repository is written by the authors, although the structure is inspired by the [GPML Toolbox](https://gitlab.com/hnickisch/gpml-matlab).

**NOTE 3:** We recommend, if possible, to use the *Parallel Computing Toolbox* if you wish to perform more extensive calculations, although the toolbox is not required. In case you want to use this toolbox, edit the optional argument `ParallelPool=` with the appropriate profile name.

**NOTE 4:** Matlab r2021a or later is required to run.

## +GP_Gamma
The methodological implementation is provided in the namespace folder `+GP_Gamma/`. Four main functions are to be called from public files to apply the GPR:

`+GP_Gamma/spectral.m`: Constructs the spectral decomposition of the covariance kernel, needed for efficient computation. \\
`+GP_Gamma/infer.m`: Infers the division rate, used to make predictions. \\
`+GP_Gamma/train.m`: Trains the hyperparameters. \\
`+GP_Gamma/simulate.m`: Performs a forward simulation to predict the NDF from an inferred division rate.

Files under `+GP_Gamma/+Support/` are usually supporting files, and often include files to prevent rewriting larger chunks of code.

## evaluate_chlamy_*.m
Main files to call, and illustrate how to use the `+GP_Gamma` namespace. The most important calculations occur within the function call `GP_Gamma.Support.MultipleBeta()`, which can evaluate for multiple division kernel candidates and different regularization constants. After this script is completed, the simulation results are stored in the variable`kernel_result`. However, we recommend to save the entire workspace rather than the single variable (via the command `save()`).

## analyze_chlamy_*.mlx
Live script to help visualize some of the results obtained in `evaluate_chlamy_*.m`. For this function, you need to load the entire saved workspace coming from `evaluate_chlamy_*.mlx`.
